<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Notizie aggiornate</title>
</head>
<body>
  <h1>Elenco notizie</h1>
  <div id="notizie"></div>

  <script>
    function caricaNotizie() {
      fetch('http://127.0.0.1:5000/notizie')
        .then(response => {
          if (!response.ok) {
            throw new Error(`Errore HTTP: ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          const container = document.getElementById('notizie');
          container.innerHTML = '';
          if (data && data.length > 0) {
            data.forEach(item => {
              const div = document.createElement('div');
              div.className = 'notizia';
              div.innerHTML = `
                <h2>${item.titolo}</h2>
                <p>${item.testo}</p>
                <hr>
              `;
              container.appendChild(div);
            });
          } else {
            container.innerHTML = '<p>Nessuna notizia</p>';
          }

        })
        .catch(error => {
          console.error('Errore in lettura:', error);
          document.getElementById('notizie').innerHTML =
            '<p>Errore nel caricamento delle notizie.</p>';
        });
    }

    // Carica subito le notizie al primo avvio
    caricaNotizie();

    // Ricarica le notizie ogni 5 secondi (5000 ms)
    setInterval(caricaNotizie, 5000);
  </script>
</body>
</html>